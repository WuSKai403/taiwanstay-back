# TaiwanStay AI 協作指南 (Gemini AI Studio 免費版)

本文件旨在提供一套標準化的工作流程，指導開發者如何高效、安全地利用 Gemini AI Studio (免費網頁版) 來加速 `taiwanstay-back` 專案的開發。遵循此指南可以最大限度地發揮 AI 的程式碼生成能力，同時避免專案後期可能出現的架構混亂問題。

核心原則：**將 Gemini AI Studio 視為您的資深結對程式設計師，並由您擔任「專案架構師」與「AI 上下文管理者」的角色。**

---

## 1. 基礎工作流程：分層請求

此工作流程適合專案初期或實作簡單功能時使用。

### 步驟 1: 建立初始對話上下文

在每一個新的 Gemini AI Studio 對話開始時，必須先提供足夠的背景資訊。

1.  **貼上核心開發指南**: 將 `DEVELOPMENT_GUIDE.md` 的**全部內容**複製貼上。
2.  **賦予 AI 角色**: 在開頭加入明確的指令，例如：
    > 「你現在是一位資深的 Go 後端工程師。我們將合作完成 `taiwanstay-back` 專案。以下是專案的核心開發指南，你必須嚴格遵守。請先閱讀並理解。」
3.  **提供現有程式碼**: 貼上新功能會互動到的現有、關鍵檔案內容 (例如 `user.go` 的 struct 定義)。

### 步驟 2: 遵循開發閉環，逐層請求

按照 `DEVELOPMENT_GUIDE.md` 中定義的開發流程，一次請求一個架構分層的程式碼。

1.  **請求 Domain 層**: `internal/domain/opportunity.go`
2.  **請求 Repository 層**: `internal/repository/opportunity_repo.go`
3.  **請求 Service 層**: `internal/service/opportunity_service.go`
4.  **請求 Handler 層**: `internal/api/opportunity_handler.go`

### 步驟 3: 迭代循環 (實作 -> 測試 -> 修正)

1.  **複製與貼上**: 將 AI 產生的程式碼貼到本地端的 VS Code。
2.  **測試與檢查**: 在本地執行 `go build` 或 `go test`。
3.  **回報錯誤**: 將**完整的錯誤訊息**和**相關的程式碼片段**貼回給 AI，請求修正。

---

## 2. 高效加速策略：請求「功能切片 (Vertical Slice)」

當您對流程熟悉後，應採用此策略以大幅提升效率。核心是**一次性要求 AI 產出實現一個完整用戶故事所需的所有程式碼。**

### 步驟 1: 準備整合式提示 (Integrated Prompt)

設計一個清晰的提示，描述完整的功能需求，並要求 AI 產出所有相關檔案。

**範例提示 (建立書籤功能):**

> 「我們要實作『建立書籤』的功能。請根據我們的開發指南，為這個功能產生所有必要的程式碼。
>
> **功能需求：**
> 一個登入的使用者可以將某個『工作機會』加入自己的書籤。
>
> **請為我產生以下檔案的完整程式碼：**
> 1. `internal/domain/bookmark.go`: (描述 struct 欄位...)
> 2. `internal/repository/bookmark_repo.go`: (描述介面、方法和索引需求...)
> 3. `internal/service/bookmark_service.go`: (描述業務邏輯...)
> 4. `internal/api/bookmark_handler.go`: (描述 Handler 和 DTO 需求...)
> 5. **路由註冊**: 告訴我應如何修改 `internal/api/router.go`。
>
> **輸出格式要求：**
> 請將每個檔案的程式碼都放在一個獨立的 Markdown 程式碼區塊中，並標明完整的檔案路徑。」

### 步驟 2: 一次性複製與整體測試

1.  **一次性複製**: 將 AI 產出的所有程式碼塊，一次性地複製到本地對應的檔案中。
2.  **整體測試**: 立即對整個新功能進行從 API 到資料庫的完整測試。

---

## 3. 專案後期策略：上下文刷新與校準

當專案變得複雜，新功能需要與多個現有模組互動時，必須採用此策略來避免架構混亂。

### 步驟 1: 準備「上下文刷新包 (Context Refresh Packet)」

在發起新的功能切片請求前，整理一份**當前系統狀態的濃縮摘要**。

**刷新包內容：**

1.  **專案憲法**: `DEVELOPMENT_GUIDE.md`。
2.  **關鍵契約 (Interfaces)**: **只貼出**所有相關模組的 `Service` 和 `Repository` **介面定義**。這是最重要的部分。
3.  **核心名詞 (Structs)**: 新功能會用到的核心 `Domain` 模型定義。
4.  **系統骨架**: `cmd/server/main.go` 中的依賴注入部分和 `internal/api/router.go` 的路由設定。

### 步驟 2: 發起「校準後的功能切片請求」

在一個**新的** Gemini AI Studio 對話中，發起一個包含兩部分的提示：

1.  **第一部分 (上下文刷新)**:
    > 「...我們正在合作開發 `taiwanstay-back` 專案。以下是專案的最新架構狀態，包含開發指南、所有核心介面和相關模型。請你先閱讀並以此為基礎進行後續的程式碼生成。」
    >
    > **(在這裡貼上您準備好的「上下文刷新包」)**

2.  **第二部分 (新的功能切片需求)**:
    > 「基於以上最新的上下文，我們現在要實作... (描述您的新功能需求)。請確保所有新產生的程式碼都與我剛剛提供的現有介面和架構**完全相容**。」

### 為何此策略至關重要？

-   **您是唯一的真理來源**: 強制 AI 基於您提供的最新程式碼現況進行工作，而不是依賴其可能過時的對話歷史。
-   **從「猜測」到「遵循」**: AI 的工作模式從猜測如何與舊程式碼互動，轉變為嚴格遵循您提供的介面契約，確保了程式碼的相容性和架構的一致性。
-   **維護專案完整性**: 透過定期校準，您可以確保即使是複雜的功能，也能在現有的、穩固的架構上進行擴展，而不是破壞它。
